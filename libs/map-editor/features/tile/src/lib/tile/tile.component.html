<div class="tile" cdkDrag [cdkDragFreeDragPosition]="dragPosition()">
  <div class="controls">
    <button><i class="fa-solid fa-pen" (click)="editTile()"></i></button>
    <span cdkDragHandle class="move" (mouseup)="snap($event)" (touchend)="snap($event)">
      <i class="fa-solid fa-up-down-left-right"></i>
    </span>
    <button (click)="delete()"><i class="fa-regular fa-trash-can"></i></button>
    <button class="rotate-button" (click)="rotate()"><i class="fa-solid fa-rotate-right"></i></button>
  </div>
  <div class="game-components" [style.rotate]="rotation()" [style.opacity]="suggestedPlacement()">
    <div class="row">
      <div class="cell"><app-cube [id]="tileData().cubes[0]" ></app-cube><app-portrait [id]="tileData().hero[0]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[0]"></app-blocked-hex></div>
      <div class="cell"><app-cube [id]="tileData().cubes[1]" ></app-cube><app-portrait [id]="tileData().hero[1]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[1]"></app-blocked-hex></div>
    </div>
    <div class="row">
      <div class="cell"><app-cube [id]="tileData().cubes[2]" ></app-cube><app-portrait [id]="tileData().hero[2]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[2]"></app-blocked-hex></div>
      <div class="cell"><app-cube [id]="tileData().cubes[3]" ></app-cube><app-portrait [id]="tileData().hero[3]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[3]"></app-blocked-hex></div>
      <div class="cell"><app-cube [id]="tileData().cubes[4]" ></app-cube><app-portrait [id]="tileData().hero[4]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[4]"></app-blocked-hex></div>
    </div>
    <div class="row">
      <div class="cell"><app-cube [id]="tileData().cubes[5]" ></app-cube><app-portrait [id]="tileData().hero[5]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[5]"></app-blocked-hex></div>
      <div class="cell"><app-cube [id]="tileData().cubes[6]" ></app-cube><app-portrait [id]="tileData().hero[6]"></app-portrait><app-blocked-hex [visible]="tileData().blockedHex[6]"></app-blocked-hex></div>
    </div>
  </div>
  <img src="{{image()}}" alt="{{desc()}}" [style.rotate]="rotation()" [style.opacity]="suggestedPlacement()">
  @if(factionBorder() !== '') {
    <div [ngClass]="['town-overlay', factionBorder()]">
      <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
           width="300.000000pt" height="290.000000pt" viewBox="0 0 300.000000 290.000000"
           preserveAspectRatio="xMidYMid meet">
        <metadata>
          Created by potrace 1.10, written by Peter Selinger 2001-2011
        </metadata>
        <g transform="translate(0.000000,290.000000) scale(0.100000,-0.100000)"
           fill="#000000" stroke="none">
          <path d="M743 2749 l-243 -141 0 -291 -1 -292 -245 -140 -245 -141 0 -294 0
              -294 108 -62 c59 -35 170 -98 245 -141 l138 -78 0 -291 0 -292 238 -138 c131
              -77 248 -139 262 -139 14 0 128 60 263 138 l237 139 245 -142 c163 -94 252
              -141 264 -137 11 3 126 66 255 142 l236 137 0 294 c0 162 3 294 8 294 4 0 114
              62 245 138 l238 138 0 294 0 294 -153 89 c-84 49 -195 113 -245 143 l-93 55 0
              289 0 289 -42 25 c-24 13 -133 77 -243 141 -127 74 -208 115 -221 112 -11 -2
              -127 -65 -257 -141 l-236 -137 -243 140 c-133 78 -249 141 -258 141 -8 0 -124
              -63 -257 -141z m513 -65 c127 -73 237 -134 244 -134 7 0 119 62 249 137 130
              76 243 137 251 137 8 0 111 -55 228 -123 l212 -123 0 -282 c1 -205 4 -285 13
              -297 7 -9 57 -42 112 -74 55 -32 161 -93 235 -136 l135 -78 3 -260 2 -260 -77
              -44 c-267 -151 -399 -231 -408 -245 -6 -10 -12 -139 -15 -300 l-5 -283 -218
              -125 -217 -125 -173 99 c-94 55 -204 118 -243 141 -39 23 -77 41 -84 41 -7 0
              -122 -63 -256 -141 l-244 -141 -72 42 c-40 24 -139 81 -220 127 l-148 85 0
              284 c0 262 -1 285 -18 302 -10 10 -77 52 -148 93 -71 40 -141 81 -155 89 -14
              8 -60 34 -102 58 l-77 43 0 259 0 259 78 44 c42 24 122 70 177 102 55 32 127
              74 160 92 33 19 66 41 73 50 9 13 12 89 12 299 l0 282 218 126 c120 70 224
              123 232 120 8 -3 119 -66 246 -140z"/>
        </g>
      </svg>
    </div>
  }
</div>

